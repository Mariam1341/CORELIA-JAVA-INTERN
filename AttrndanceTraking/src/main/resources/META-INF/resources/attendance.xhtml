<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">

<h:head>
    <title>Attendance Management</title>
</h:head>
<h:body style="font-family: Arial, sans-serif; background-color: #f4f6f8;">

    <p:growl id="messages" showDetail="true" life="3000" />

    <div style="width:80%; margin:auto; margin-top:30px;">
        <!-- لوحة التحكم -->
        <p:panel  header="Manage Attendance" style="margin-bottom:20px;">
            <h:form id="manageForm">
                <h:panelGrid columns="2" columnClasses="label,value" cellpadding="8" style="width:100%;">
                    <h:outputLabel for="employee" value="Employee:" />
                    <p:inputText id="employee" value="#{attendanceView.selectedRecord.employeeName}" 
                                 placeholder="Enter employee name" style="width:100%;" />

                    <h:outputLabel for="date" value="Date:" />
                    <p:calendar id="date" value="#{attendanceView.selectedRecord.date}" 
                                pattern="yyyy-MM-dd" showIcon="true" />

                    <h:outputLabel for="present" value="Present:" />
                    <p:selectBooleanCheckbox id="present" value="#{attendanceView.selectedRecord.present}" />
                </h:panelGrid>

                <div style="margin-top:15px; text-align:right;">
                    <p:commandButton value="Save" 
                                     action="#{attendanceView.saveRecord}"
                                     process="@form"
                                     update=":tableForm:attendanceTable :manageForm :messages"
                                     styleClass="ui-button-success" />
                    <p:commandButton value="Clear" 
                                     action="#{attendanceView.clearForm}"
                                     process="@this"
                                     update=":manageForm"
                                     style="margin-left:10px;" />
                </div>
            </h:form>
        </p:panel>

        <!-- جدول الحضور -->
        <p:panel header="Attendance Records">
            <h:form id="tableForm">
                <p:dataTable id="attendanceTable"
                             var="rec"
                             value="#{attendanceView.records}"
                             selectionMode="single"
                             selection="#{attendanceView.selectedRecord}"
                             rowKey="#{rec.id}"
                             paginator="true" rows="8"
                             style="width:100%;">

                    <p:ajax event="rowSelect" process="@this" update=":manageForm" />

                    <p:column headerText="ID" style="width:60px;">
                        <h:outputText value="#{rec.id}" />
                    </p:column>

                    <p:column headerText="Employee">
                        <h:outputText value="#{rec.employeeName}" />
                    </p:column>

                    <p:column headerText="Date">
                        <h:outputText value="#{rec.date}">
                            <f:convertDateTime pattern="yyyy-MM-dd" />
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Present" style="text-align:center;">
    <h:outputText value="#{rec.present ? 'Yes' : 'No'}"
                  style="color: #{rec.present ? 'green' : 'red'}; font-weight:bold;" />
</p:column>


                    <p:column headerText="Actions" style="text-align:center; width:120px;">
                        <p:commandButton value="Delete" title="Delete"
                                         action="#{attendanceView.deleteRecord(rec.id)}"
                                         process="@this"
                                         update=":tableForm:attendanceTable :manageForm :messages"
                                         styleClass="ui-button-danger" />
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:panel>
    </div>

</h:body>
</html>
